"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getRewritePath = void 0;
const matcher_1 = require("./matcher");
function getRewritePath(path, routesManifest, router, normalisedPath) {
    const rewrites = routesManifest.rewrites;
    for (const rewrite of rewrites) {
        const match = matcher_1.matchPath(path, rewrite.source);
        if (match) {
            const destination = matcher_1.compileDestination(rewrite.destination, match.params);
            if (path === destination) {
                const url = router(normalisedPath);
                if (url === "pages/404.html" || url === "pages/_error.js") {
                    continue;
                }
            }
            return destination;
        }
    }
    return null;
}
exports.getRewritePath = getRewritePath;
